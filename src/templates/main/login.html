{% extends 'base.html' %}
{% load static %}

{% block title %}Login - Afrimart{% endblock %}

{% block content %}
<div class="container my-5 py-5">
    <div class="row justify-content-center">
        <div class="col-md-6 col-lg-5">
            

            <div class="card border p-4 p-md-5 shadow-0">
                <div class="text-center mb-4">
                    <a href="{% url 'home' %}">
                        <img src="{% static 'assets/images/logo.png' %}" alt="Afrimart" style="height: 34px; width: auto;">
                    </a>
                </div>
                <div class="mb-4 text-center">
                    <h3 class="fw-bold mb-1">Welcome Back</h3>
                    <p class="text-muted small">Login to your Afrimart account</p>
                </div>

                {% if form.non_field_errors %}
                    <div class="alert alert-danger rounded-0 border-0 small mb-4 p-2" style="padding-bottom: 0px !important;" role="alert">
                        {{ form.non_field_errors }}
                    </div>
                {% endif %}

                <form method="post">
                    {% csrf_token %}

                    <div class="mb-4">
                        <label class="form-label x-small fw-bold text-uppercase text-muted" style="letter-spacing: 1px;">Username or Email</label>
                        <input 
                            type="text" 
                            name="{{ form.username.name }}" 
                            class="form-control form-control-lg bg-light {% if form.username.errors %}is-invalid{% endif %}" 
                            placeholder="Enter username"
                            value="{{ form.username.value|default:'' }}"
                            required
                            style="font-size: 14px;"
                        >
                        {% if form.username.errors %}
                            <div class="text-danger x-small mt-1">{{ form.username.errors.0 }}</div>
                        {% endif %}
                    </div>

                    <div class="mb-4">
                        <div class="d-flex justify-content-between align-items-center mb-1">
                            <label class="form-label x-small fw-bold text-uppercase text-muted m-0" style="letter-spacing: 1px;">Password</label>
                            <a href="#" class="text-decoration-none x-small fw-bold" style="color: var(--primary-green);">Forgot?</a>
                        </div>
                        <div class="input-group">
                            <input 
                                type="password" 
                                name="{{ form.password.name }}" 
                                id="{{ form.password.id_for_label }}"
                                class="form-control form-control-lg bg-light border-end-0 {% if form.password.errors %}is-invalid{% endif %}" 
                                placeholder="••••••••"
                                required
                                style="font-size: 14px;"
                            >
                            <button type="button" class="input-group-text bg-light border-start-0 px-3 text-muted" id="togglePassword">
                                <ion-icon name="eye-outline" id="eyeIcon"></ion-icon>
                            </button>
                        </div>
                        {% if form.password.errors %}
                            <div class="text-danger x-small mt-1">{{ form.password.errors.0 }}</div>
                        {% endif %}
                    </div>

                    <div class="mb-4">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="rememberMe">
                            <label class="form-check-label x-small text-muted fw-bold" for="rememberMe">
                                Remember me
                            </label>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-lg w-100 py-3 text-uppercase fw-bold border-0 text-white" 
                            style="background-color: var(--primary-green); font-size: 13px; letter-spacing: 1px;">
                        Login to Account
                    </button>
                </form>

                <div class="text-center mt-4 pt-3 border-top">
                    <p class="mb-0 small text-muted">
                        Don't have an account? 
                        <a href="{% url 'register' %}" class="fw-bold text-decoration-none" style="color: var(--primary-green);">
                            Join Afrimart
                        </a>
                    </p>
                </div>
            </div>

            <div class="d-flex justify-content-center gap-4 mt-4 text-muted opacity-50">
                <div class="text-center">
                    <ion-icon name="shield-checkmark-outline" class="fs-4"></ion-icon>
                    <p style="font-size: 10px;" class="text-uppercase fw-bold mt-1">Secure</p>
                </div>
                <div class="text-center">
                    <ion-icon name="airplane-outline" class="fs-4"></ion-icon>
                    <p style="font-size: 10px;" class="text-uppercase fw-bold mt-1">Global</p>
                </div>
                <div class="text-center">
                    <ion-icon name="headset-outline" class="fs-4"></ion-icon>
                    <p style="font-size: 10px;" class="text-uppercase fw-bold mt-1">Support</p>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    /* Force flat UI */
    .card, .form-control, .input-group-text, .btn, .form-check-input { border-radius: 0 !important; }
    .form-control, .input-group-text { border-color: var(--border-light); }
    
    .x-small { font-size: 11px; }

    .form-control:focus {
        border-color: var(--primary-green);
        box-shadow: none;
        background: #fff;
    }

    .form-check-input:checked {
        background-color: var(--primary-green);
        border-color: var(--primary-green);
    }

    #togglePassword {
        cursor: pointer;
        transition: color 0.2s;
    }
    #togglePassword:hover {
        color: var(--primary-green) !important;
    }

    .btn:hover {
        filter: brightness(1.1);
        transition: 0.3s ease;
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const togglePassword = document.getElementById('togglePassword');
        const passwordInput = document.getElementById('{{ form.password.id_for_label }}');
        const eyeIcon = document.getElementById('eyeIcon');

        if (togglePassword && passwordInput) {
            togglePassword.addEventListener('click', function() {
                const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                passwordInput.setAttribute('type', type);
                eyeIcon.setAttribute('name', type === 'password' ? 'eye-outline' : 'eye-off-outline');
            });
        }
    });
</script>
{% endblock %}